/* ========================================
   АДАПТИВНЫЙ CSS ДЛЯ ПРОЕКТА "НАРЯДИ ЁЛОЧКУ"
   Использует rem-единицы для корректного масштабирования
   ======================================== */

/* ========== БАЗОВЫЕ СТИЛИ ========== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* Устанавливаем базовый размер rem: 1rem = 1px при ширине 1920px для игрового поля */
:root {
  --game-scale: calc(100vw / 1920);
}

html {
  font-size: var(--game-scale); /* Для игрового поля */
}

/* Панель управления использует стандартный размер rem (16px) */
#control-panel,
#control-panel * {
  font-size: 16px; /* Фиксированный размер для панели управления */
}

body {
  background-color: #f5f5f5;
  background-image: url('assets/images/background1.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  overflow: hidden; /* Убираем прокрутку полностью */
  font-family: 'Arial', sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh; /* Фиксированная высота вместо min-height */
  width: 100vw; /* Фиксированная ширина */
}

/* Обертка для центрирования игрового поля */
#game-wrapper {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100vh; /* Фиксированная высота */
  padding: 0; /* Убираем padding, чтобы игровое поле занимало весь экран */
}

/* Контейнер-сцена для всех элементов с фиксированным соотношением сторон */
#scene-container {
  position: relative;
  width: 1920rem;
  height: 1080rem;
  aspect-ratio: 1920 / 1080;
  max-width: 100vw;
  max-height: 100vh;
}

/* ========== ФОН КОМНАТЫ ========== */
.room-background {
  display: none; /* Фон теперь на body, этот элемент не нужен */
}

/* ========== КАМИН ========== */
#fireplace-container {
  position: absolute;
  top: 350rem; /* Подняли камин выше */
  left: 300rem;
  width: 560rem;
  height: auto;
  z-index: 2;
}

#fireplace {
  width: 100%;
  height: auto;
  display: block;
  filter: drop-shadow(5rem 5rem 10rem rgba(0, 0, 0, 0.3));
}

/* Пламя в камине */
#fireplace-flame {
  position: absolute;
  animation: none;
  top: 45%;
  left: 30%;
  width: 40%;
  height: 25%;
  background: radial-gradient(ellipse at center bottom, 
    rgba(255, 200, 0, 0.6) 0%, 
    rgba(255, 150, 0, 0.5) 20%,
    rgba(255, 100, 0, 0.4) 40%,
    rgba(255, 50, 0, 0.2) 60%,
    transparent 80%);
  border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
  z-index: 3;
  pointer-events: none;
  mix-blend-mode: screen;
  opacity: 0;
}

#fireplace-flame.animated {
  animation: fireFlicker 2s ease-in-out infinite;
  opacity: 1;
}

  /* Анимация пламени */
  @keyframes fireFlicker {
    0%, 100% {
      filter: brightness(1) hue-rotate(0deg);
      transform: scaleY(1) scaleX(1) translateX(0) rotate(0deg);
      opacity: 0.9;
    }
    12.5% {
      filter: brightness(1.15) hue-rotate(5deg);
      transform: scaleY(1.05) scaleX(1.02) translateX(-3rem) rotate(-1deg);
      opacity: 1;
    }
    25% {
      filter: brightness(1.2) hue-rotate(3deg);
      transform: scaleY(1.03) scaleX(1.01) translateX(2rem) rotate(1deg);
      opacity: 1;
    }
    37.5% {
      filter: brightness(1.25) hue-rotate(-3deg);
      transform: scaleY(0.95) scaleX(0.98) translateX(-1rem) rotate(-0.5deg);
      opacity: 0.95;
    }
    50% {
      filter: brightness(1.25) hue-rotate(-3deg);
      transform: scaleY(0.95) scaleX(0.98) translateX(3rem) rotate(1.5deg);
      opacity: 0.95;
    }
    62.5% {
      filter: brightness(1.2) hue-rotate(3deg);
      transform: scaleY(1.02) scaleX(1.01) translateX(-3rem) rotate(-1.5deg);
      opacity: 1;
    }
    75% {
      filter: brightness(1.2) hue-rotate(3deg);
      transform: scaleY(1.02) scaleX(1.01) translateX(2rem) rotate(1deg);
      opacity: 1;
    }
    87.5% {
      filter: brightness(1.15) hue-rotate(5deg);
      transform: scaleY(1.05) scaleX(1.02) translateX(-2rem) rotate(-1deg);
      opacity: 1;
    }
  }

/* Гирлянда на камине */
#fireplace-decoration {
  position: absolute;
  top: 310rem; /* Подняли гирлянду выше вместе с камином */
  left: 425rem;
  width: 280rem;
  height: auto;
  z-index: 3;
}

#fireplace-decoration.lit {
  filter: brightness(1.1);
}

/* Белые точки на гирлянде камина */
.decoration-bulb {
  position: absolute;
  width: 4rem;
  height: 4rem;
  background-color: white;
  border-radius: 50%;
  pointer-events: none;
  z-index: 4;
  box-shadow: 0 0 6rem rgba(255, 255, 255, 0.8), 0 0 12rem rgba(255, 255, 255, 0.6);
  animation: decorationBulbTwinkle 1.5s ease-in-out infinite;
}

@keyframes decorationBulbTwinkle {
  0%, 100% {
    opacity: 0.3;
    transform: scale(0.8);
  }
  50% {
    opacity: 1;
    transform: scale(1.2);
  }
}

/* ========== ОКНО С СНЕЖИНКАМИ ========== */
#window-container {
  position: absolute;
  top: -50rem;
  right: -40rem;
  width: 550rem; /* Увеличили ширину окна */
  height: 780rem; /* Увеличили высоту окна */
  z-index: 2;
  transform: rotate(2deg);
  overflow: hidden;
  clip-path: polygon(0% 0%, 95% 0%, 95% 100%, 0% 100%);
}

#snowflakes-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 4;
  pointer-events: none;
  overflow: hidden;
  clip-path: polygon(
    34% 22%,
    85% 22%,
    85% 70%,
    34% 70%
  );
}

#window {
  position: absolute;
  top: 0;
  right: 0;
  width: 100%;
  height: auto;
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  z-index: 3;
  pointer-events: none;
  filter: drop-shadow(-6rem 10rem 15rem rgba(0, 0, 0, 0.6));
}

/* Снежинки */
.snowflake {
  position: absolute;
  top: -20rem;
  width: 7.2rem;
  height: 7.2rem;
  background-image: url('assets/images/snowflake.png');
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  z-index: 1;
  pointer-events: none;
  animation: none;
  opacity: 0;
  filter: blur(0.5rem) brightness(1.2);
  mix-blend-mode: screen;
}

.snowflake.animated {
  animation: snowfall linear infinite;
  opacity: 0.9;
}

@keyframes snowfall {
  0% {
    transform: translateY(0) translateX(0) rotate(0deg);
    opacity: 0;
  }
  3% {
    opacity: 0.9;
  }
  97% {
    opacity: 0.9;
  }
  100% {
    transform: translateY(600rem) translateX(30rem) rotate(360deg);
    opacity: 0;
  }
}

.snowflake::before {
  content: '❄';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10rem;
  color: white;
  text-shadow: 0 0 3rem rgba(255, 255, 255, 0.8);
  z-index: -1;
}

/* Индивидуальные настройки для каждой снежинки */
.snowflake:nth-child(1) {
  left: 36%;
  animation-duration: 8s;
  animation-delay: 0s;
  width: 5.4rem;
  height: 5.4rem;
}

.snowflake:nth-child(2) {
  left: 55%;
  animation-duration: 10s;
  animation-delay: 1s;
  width: 6.48rem;
  height: 6.48rem;
}

.snowflake:nth-child(3) {
  left: 38%;
  animation-duration: 9s;
  animation-delay: 2s;
  width: 4.86rem;
  height: 4.86rem;
}

.snowflake:nth-child(4) {
  left: 60%;
  animation-duration: 11s;
  animation-delay: 0.5s;
  width: 5.94rem;
  height: 5.94rem;
}

.snowflake:nth-child(5) {
  left: 40%;
  animation-duration: 8.5s;
  animation-delay: 1.5s;
  width: 5.4rem;
  height: 5.4rem;
}

.snowflake:nth-child(6) {
  left: 53%;
  animation-duration: 9.5s;
  animation-delay: 2.5s;
  width: 4.86rem;
  height: 4.86rem;
}

.snowflake:nth-child(7) {
  left: 57%;
  animation-duration: 10.5s;
  animation-delay: 0.8s;
  width: 7.02rem;
  height: 7.02rem;
}

.snowflake:nth-child(8) {
  left: 35%;
  animation-duration: 9s;
  animation-delay: 1.8s;
  width: 5.4rem;
  height: 5.4rem;
}

/* ========== ЁЛКА СО ЗВЕЗДОЙ ========== */
#tree-with-star {
  position: absolute;
  top: 50%;
  left: calc(50% + 96rem);
  transform: translate(-50%, -50%) scaleX(1.2);
  height: 90%;
  width: auto;
  z-index: 3;
}

#tree {
  height: 100%;
  width: auto;
  filter: drop-shadow(8rem 12rem 15rem rgba(0, 0, 0, 0.6));
}

#star {
  position: absolute;
  top: -40rem;
  left: 50%;
  transform: translateX(calc(-50% + 5rem)); /* Сдвигаем звезду немного правее */
  transform-origin: center center;
  width: 60rem;
  height: auto;
  z-index: 4;
}

#star.lit {
  animation: starGlow 2s ease-in-out infinite;
}

@keyframes starGlow {
  0%, 100% {
    filter: brightness(1) drop-shadow(0 0 10rem rgba(255, 220, 100, 0.6)) drop-shadow(0 0 20rem rgba(255, 200, 50, 0.8)) drop-shadow(0 0 30rem rgba(255, 180, 0, 0.6));
    transform: translateX(calc(-50% + 5rem)) scale(1); /* Сдвигаем звезду немного правее */
  }
  50% {
    filter: brightness(1.5) drop-shadow(0 0 20rem rgba(255, 220, 100, 1)) drop-shadow(0 0 40rem rgba(255, 200, 50, 1)) drop-shadow(0 0 60rem rgba(255, 180, 0, 0.8));
    transform: translateX(calc(-50% + 5rem)) scale(1.05); /* Сдвигаем звезду немного правее */
  }
}

/* ========== КОРОБКИ С ИГРУШКАМИ ========== */
#boxes-container {
  position: absolute;
  bottom: 5rem;
  left: calc(50% + 96rem);
  transform: translateX(-50%);
  width: 350rem;
  display: flex;
  justify-content: space-between;
  z-index: 5;
}

.box {
  width: 120rem;
  height: auto;
  cursor: pointer;
  filter: drop-shadow(5rem 8rem 12rem rgba(0, 0, 0, 0.55));
  transition: transform 0.2s ease;
}

.box:hover {
  transform: scale(1.05);
}

/* Анимация подпрыгивания для первой коробки */
@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-2rem); /* Увеличили высоту прыжка для большей заметности */
  }
}

.box[data-box="1"].bounce-hint {
  animation: bounce 0.6s ease-in-out infinite !important;
  will-change: transform;
}

/* ========== ДЕКОРАТИВНЫЕ ЭЛЕМЕНТЫ ========== */
/* Подарок 1 (слева) */
#gift1 {
  position: absolute;
  bottom: 50rem;
  left: calc(50% - 350rem + 96rem);
  width: 120rem;
  height: auto;
  z-index: 4;
  filter: drop-shadow(6rem 10rem 15rem rgba(0, 0, 0, 0.6));
}

/* Подарок 2 (справа) */
#gift2 {
  position: absolute;
  bottom: 30rem;
  left: calc(50% + 200rem + 96rem);
  width: 120rem;
  height: auto;
  z-index: 4;
  filter: drop-shadow(-5rem 8rem 12rem rgba(0, 0, 0, 0.55));
}

/* Кот */
#cat {
  position: absolute;
  bottom: 45rem;
  left: calc(50% - 550rem + 96rem);
  width: 159rem;
  height: auto;
  z-index: 4;
  filter: drop-shadow(6rem 10rem 15rem rgba(0, 0, 0, 0.6));
}

/* Хлопушка */
#fireworks {
  position: absolute;
  bottom: 25rem;
  left: calc(50% + 380rem + 96rem);
  width: 80rem;
  height: auto;
  z-index: 5;
  cursor: pointer;
  filter: drop-shadow(-5rem 8rem 12rem rgba(0, 0, 0, 0.55));
  transition: transform 0.3s ease-out;
}

#fireworks:not(.disabled):hover {
  transform: scale(1.1);
}

#fireworks.disabled {
  cursor: not-allowed;
  pointer-events: auto;
}

#fireworks.disabled:hover {
  transform: none;
}

@keyframes shake {
  0%, 100% {
    transform: translateX(0);
  }
  5%, 15%, 25%, 35%, 45%, 55%, 65%, 75%, 85%, 95% {
    transform: translateX(-5rem) rotate(-2deg);
  }
  10%, 20%, 30%, 40%, 50%, 60%, 70%, 80%, 90% {
    transform: translateX(5rem) rotate(2deg);
  }
}

/* Кукла */
#doll-gift {
  position: absolute;
  bottom: 5rem;
  left: calc(50% - 285rem + 96rem);
  width: 120rem;
  height: auto;
  z-index: 4;
}

/* ========== ПАНЕЛЬ УПРАВЛЕНИЯ ========== */
#control-panel {
  position: fixed;
  bottom: 20px; /* Используем px для фиксированного размера */
  left: 20px; /* Используем px для фиксированного размера */
  z-index: 100;
  display: flex;
  flex-direction: column;
  gap: 10px; /* Используем px для фиксированного размера */
}

#instruction-panel {
  padding: 15px 20px; /* Используем px для фиксированного размера */
  background: #2196F3;
  color: white;
  border: 4px solid white; /* Используем px для фиксированного размера */
  border-radius: 10px; /* Используем px для фиксированного размера */
  font-size: clamp(12px, 1.5vw, 14px); /* Используем px для фиксированного размера */
  font-weight: bold;
  line-height: 1.4;
  width: clamp(200px, 20vw, 250px); /* Используем px для фиксированного размера */
  box-shadow: 
    0 4px 8px rgba(0, 0, 0, 0.2),
    inset 0 2px 4px rgba(255, 255, 255, 0.3),
    inset 0 -2px 4px rgba(0, 0, 0, 0.2);
  text-align: center;
}

#restart-game {
  padding: 10px 20px; /* Используем px для фиксированного размера */
  background: #4CAF50;
  color: white;
  border: 4px solid white; /* Используем px для фиксированного размера */
  border-radius: 20px; /* Используем px для фиксированного размера */
  font-weight: bold;
  cursor: pointer;
  font-size: clamp(12px, 1.5vw, 14px); /* Используем px для фиксированного размера */
  box-shadow: 
    0 4px 8px rgba(0, 0, 0, 0.2),
    inset 0 2px 4px rgba(255, 255, 255, 0.3),
    inset 0 -2px 4px rgba(0, 0, 0, 0.2);
  transition: background 0.2s ease;
}

#restart-game:hover {
  background: #45a049;
  box-shadow: 
    0 4px 8px rgba(0, 0, 0, 0.3),
    inset 0 2px 4px rgba(255, 255, 255, 0.4),
    inset 0 -2px 4px rgba(0, 0, 0, 0.3);
}

#toggle-sound {
  padding: 10px 20px; /* Используем px для фиксированного размера */
  background: #ffcc00;
  color: #333;
  border: 4px solid white; /* Используем px для фиксированного размера */
  border-radius: 20px; /* Используем px для фиксированного размера */
  font-weight: bold;
  cursor: pointer;
  font-size: clamp(12px, 1.5vw, 14px); /* Используем px для фиксированного размера */
  box-shadow: 
    0 4px 8px rgba(0, 0, 0, 0.2),
    inset 0 2px 4px rgba(255, 255, 255, 0.4),
    inset 0 -2px 4px rgba(0, 0, 0, 0.2);
  transition: background 0.2s ease;
}

#toggle-sound:hover {
  background: #ffbb00;
  box-shadow: 
    0 4px 8px rgba(0, 0, 0, 0.3),
    inset 0 2px 4px rgba(255, 255, 255, 0.5),
    inset 0 -2px 4px rgba(0, 0, 0, 0.3);
}

/* ========== ИГРУШКИ И УКРАШЕНИЯ ========== */
#toys-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 50;
}

.toy {
  position: absolute;
  width: 100rem;
  height: auto;
  cursor: grab;
  pointer-events: auto;
  z-index: 100;
  user-select: none;
  transition: transform 0.2s ease;
}

.toy:hover {
  transform: scale(1.1);
}

.toy[data-toy*="garland"]:hover,
.toy[data-toy*="tinsel"]:hover {
  transform: translateY(-50%) scale(1);
}

.toy:active {
  cursor: grabbing;
}

.toy-on-tree {
  pointer-events: none;
  user-select: none;
}

.garland-tinsel {
  opacity: 0.9;
  filter: drop-shadow(0 0.125rem 0.25rem rgba(0, 0, 0, 0.3));
  background-clip: padding-box;
  background-origin: padding-box;
}

/* Анимация покачивания игрушек */
@keyframes sway {
  0%, 100% {
    transform: rotate(-2deg);
  }
  50% {
    transform: rotate(2deg);
  }
}

@keyframes swayGarland {
  0%, 100% {
    transform: rotate(calc(var(--garland-angle, 0deg) - 2deg));
  }
  50% {
    transform: rotate(calc(var(--garland-angle, 0deg) + 2deg));
  }
}

/* Лампочки на елке */
.tree-bulb {
  position: absolute;
  width: 6rem;
  height: 6rem;
  border-radius: 50%;
  pointer-events: none;
  z-index: 15;
  box-shadow: 0 0 10rem currentColor, 0 0 20rem currentColor, 0 0 30rem currentColor;
  animation: bulbPulse 1.5s ease-in-out infinite, bulbFadeIn 1s ease-out forwards;
  opacity: 0;
}

@keyframes bulbPulse {
  0%, 100% {
    opacity: 0.3;
    transform: scale(0.8);
    filter: brightness(0.5);
  }
  50% {
    opacity: 1;
    transform: scale(1.2);
    filter: brightness(2);
  }
}

@keyframes bulbFadeIn {
  0% {
    opacity: 0;
    transform: scale(0);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

/* Конфетти */
.confetti {
  position: fixed;
  border-radius: 50%;
  pointer-events: none;
  z-index: 1000;
  box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.3);
}

/* ========== МЕДИАЗАПРОСЫ ДЛЯ АДАПТИВНОСТИ ========== */

/* Планшеты и небольшие экраны */
@media screen and (max-width: 1024px) {
  #control-panel {
    gap: 8px; /* Используем px для фиксированного размера */
  }

  #instruction-panel {
    font-size: clamp(10px, 2vw, 12px); /* Используем px для фиксированного размера */
    padding: 10px 15px; /* Используем px для фиксированного размера */
  }

  #restart-game,
  #toggle-sound {
    font-size: clamp(10px, 2vw, 12px); /* Используем px для фиксированного размера */
    padding: 8px 15px; /* Используем px для фиксированного размера */
  }
}

/* Мобильные устройства (< 768px) */
@media screen and (max-width: 768px) {
  /* Игровое поле масштабируется автоматически благодаря aspect-ratio и rem */
  /* Панель управления переносится вниз и по центру */
  #control-panel {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    gap: 8px; /* Используем px для фиксированного размера */
    padding: 10px; /* Используем px для фиксированного размера */
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(10px); /* Используем px для фиксированного размера */
  }

  #instruction-panel {
    width: 100%;
    max-width: 320px; /* Используем px для фиксированного размера */
    font-size: 12px; /* Используем px для фиксированного размера */
    padding: 8px 12px; /* Используем px для фиксированного размера */
    order: 3;
  }

  #restart-game,
  #toggle-sound {
    font-size: 12px; /* Используем px для фиксированного размера */
    padding: 8px 16px; /* Используем px для фиксированного размера */
    flex: 1;
    min-width: 128px; /* Используем px для фиксированного размера */
  }

  #restart-game {
    order: 1;
  }

  #toggle-sound {
    order: 2;
  }

  /* Уменьшаем padding обертки на мобильных */
  #game-wrapper {
    padding: 8px; /* Используем px для фиксированного размера */
  }
}

/* Очень маленькие экраны (< 480px) */
@media screen and (max-width: 480px) {
  #instruction-panel {
    font-size: 10px; /* Используем px для фиксированного размера */
    padding: 6px 8px; /* Используем px для фиксированного размера */
    max-width: 288px; /* Используем px для фиксированного размера */
  }

  #restart-game,
  #toggle-sound {
    font-size: 10px; /* Используем px для фиксированного размера */
    padding: 6px 12px; /* Используем px для фиксированного размера */
    min-width: 96px; /* Используем px для фиксированного размера */
  }

  /* Еще меньше padding на очень маленьких экранах */
  #game-wrapper {
    padding: 4px; /* Используем px для фиксированного размера */
  }
}
